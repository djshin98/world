<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <script>

        
function elements(heles) {
    this.elements = heles;
    this.select = function(s) {
        let l = [];
        this.elements.map(ele=>{
            let a = ele.querySelectorAll(s);
            if (a instanceof NodeList) {
                a.forEach(i => { l.push(i); });
            } else if (a instanceof HTMLElement) {
                l.push(a);
            }
        })
        return new elements(l);
    }
    this.pselect = function(s){
        let l = [];
        this.elements.map(ele=>{
            let parent = ele.parentElement;
            while( parent ){
                if( parent.matches(s) === true ){
                    l.push(ele.p);
                }
                parent = parent.parentElement;
            }
        })
        return new elements(l);
    }
    this.destroy = function(){
        this.elements.forEach(ele=>{ ele = null; });
        this.elements = [];
    }
    this.attr = function(name,val,callback){
        if( name ){
            this.elements.forEach(ele=>{
                if( val ){
                    ele.setAttribute(name,val);
                }else{
                    !callback || callback(ele,name,ele.getAttribute(name));
                }
            });
        }
        return this;
    }
    this.removeAttr = function(name){
        this.elements.forEach(ele=>{
            ele.removeAttribute(name);
        });
        return this;
    }
    this.remove = function(){
        this.elements.forEach(ele=>{
            ele.remove();
        });
        return this;
    }
    this.add = function(a,callback){
        if (typeof(a) == "string") {
            this.add( this.h2e(a) ,callback);
        } else if (typeof(a) == "object") {
            if (a instanceof NodeList) {
                a.forEach(i => { this.add(i,callback); });
            } else if (a instanceof HTMLElement) {
                this.elements.forEach(ele=>{
                    !callback || callback(ele,a);
                    if( a.tagName.toUpperCase() === "SCRIPT" ){
                        eval(a.textContent);
                    }
                });
            }
        }
        return this;
    }
    this.append = function(a){
        return this.add(a,function(ele,addEle){
            ele.append(addEle);
        });
    }
    this.prepend = function(a){
        return this.add(a,function(ele,addEle){
            ele.prepend(addEle);
        });
    }
    this.h2e = function(html) {
        var template = document.createElement('template');
        template.innerHTML = html;
        return template.content.childNodes;
    }
}

function e(a) {
    if (typeof(a) == "string") {
        return e(document.querySelectorAll(a));
    } else if (typeof(a) == "object") {
        if (a instanceof NodeList) {
            let l = [];
            a.forEach(i => { l.push(i); });
            return new elements(l);
        } else if (a instanceof HTMLElement) {
            return new elements([a]);
        }
    }
}

    </script>
</head>
<body>
    aaa
</body>
</html>