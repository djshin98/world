ui.shape=function(e,s){var d,o=s.selector,t=s.error,r=s.className,l=(e.querySelectorAll(o.sides),e.querySelectorAll(o.side),!1);return d={initialize:function(){d.verbose("Initializing module for",e),d.set.defaultSide()},refresh:function(){d.verbose("Refreshing selector cache for",e),$module=$(e),$sides=$(this).find(o.shape),$side=$(this).find(o.side)},repaint:function(){d.verbose("Forcing repaint event");($sides[0]||document.createElement("div")).offsetWidth},animate:function(e,t){d.verbose("Animating box with properties",e),t=t||function(e){d.verbose("Executing animation callback"),void 0!==e&&e.stopPropagation(),d.reset(),d.set.active()},s.beforeChange.call($nextSide[0]),d.get.transitionEvent()?(d.verbose("Starting CSS animation"),$module.classList.add(r.animating),$sides.css(e).one(d.get.transitionEvent(),t),d.set.duration(s.duration),requestAnimationFrame(function(){$module.classList.add(r.animating),$activeSide.classList.add(r.hidden)})):t()},queue:function(e){d.debug("Queueing animation of",e),$sides.one(d.get.transitionEvent(),function(){d.debug("Executing queued animation"),setTimeout(function(){$module.shape(e)},0)})},reset:function(){d.verbose("Animating states reset"),$module.classList.remove(r.animating).attr("style","").removeAttr("style"),$sides.attr("style","").removeAttr("style"),$side.attr("style","").removeAttr("style").classList.remove(r.hidden),$nextSide.classList.remove(r.animating).attr("style","").removeAttr("style")},is:{complete:function(){return $side.filter("."+r.active)[0]==$nextSide[0]},animating:function(){return $module.classList.contains(r.animating)}},set:{defaultSide:function(){$activeSide=$module.find("."+s.className.active),$nextSide=0<$activeSide.next(o.side).length?$activeSide.next(o.side):$module.find(o.side).first(),l=!1,d.verbose("Active side set to",$activeSide),d.verbose("Next side set to",$nextSide)},duration:function(e){e="number"==typeof(e=e||s.duration)?e+"ms":e,d.verbose("Setting animation duration",e),(s.duration||0===s.duration)&&$sides.add($side).css({"-webkit-transition-duration":e,"-moz-transition-duration":e,"-ms-transition-duration":e,"-o-transition-duration":e,"transition-duration":e})},currentStageSize:function(){var e=$module.find("."+s.className.active),t=e.outerWidth(!0),i=e.outerHeight(!0);$module.css({width:t,height:i})},stageSize:function(){var e=$module.clone().classList.add(r.loading),t=e.find("."+s.className.active),i=l?e.find(o.side).eq(l):0<t.next(o.side).length?t.next(o.side):e.find(o.side).first(),n="next"==s.width?i.outerWidth(!0):"initial"==s.width?$module.width():s.width,a="next"==s.height?i.outerHeight(!0):"initial"==s.height?$module.height():s.height;t.classList.remove(r.active),i.classList.add(r.active),e.insertAfter($module),e.remove(),"auto"!=s.width&&($module.css("width",n+s.jitter),d.verbose("Specifying width during animation",n)),"auto"!=s.height&&($module.css("height",a+s.jitter),d.verbose("Specifying height during animation",a))},nextSide:function(e){l=e,$nextSide=$side.filter(e),l=$side.index($nextSide),0===$nextSide.length&&(d.set.defaultSide(),d.error(t.side)),d.verbose("Next side manually set to",$nextSide)},active:function(){d.verbose("Setting new side to active",$nextSide),$side.classList.remove(r.active),$nextSide.classList.add(r.active),s.onChange.call($nextSide[0]),d.set.defaultSide()}},flip:{up:function(){if(!d.is.complete()||d.is.animating()||s.allowRepeats)if(d.is.animating())d.queue("flip up");else{d.debug("Flipping up",$nextSide);var e=d.get.transform.up();d.set.stageSize(),d.stage.above(),d.animate(e)}else d.debug("Side already visible",$nextSide)},down:function(){if(!d.is.complete()||d.is.animating()||s.allowRepeats)if(d.is.animating())d.queue("flip down");else{d.debug("Flipping down",$nextSide);var e=d.get.transform.down();d.set.stageSize(),d.stage.below(),d.animate(e)}else d.debug("Side already visible",$nextSide)},left:function(){if(!d.is.complete()||d.is.animating()||s.allowRepeats)if(d.is.animating())d.queue("flip left");else{d.debug("Flipping left",$nextSide);var e=d.get.transform.left();d.set.stageSize(),d.stage.left(),d.animate(e)}else d.debug("Side already visible",$nextSide)},right:function(){if(!d.is.complete()||d.is.animating()||s.allowRepeats)if(d.is.animating())d.queue("flip right");else{d.debug("Flipping right",$nextSide);var e=d.get.transform.right();d.set.stageSize(),d.stage.right(),d.animate(e)}else d.debug("Side already visible",$nextSide)},over:function(){!d.is.complete()||d.is.animating()||s.allowRepeats?d.is.animating()?d.queue("flip over"):(d.debug("Flipping over",$nextSide),d.set.stageSize(),d.stage.behind(),d.animate(d.get.transform.over())):d.debug("Side already visible",$nextSide)},back:function(){!d.is.complete()||d.is.animating()||s.allowRepeats?d.is.animating()?d.queue("flip back"):(d.debug("Flipping back",$nextSide),d.set.stageSize(),d.stage.behind(),d.animate(d.get.transform.back())):d.debug("Side already visible",$nextSide)}},get:{transform:{up:function(){return{transform:"translateY("+-($activeSide.outerHeight(!0)-$nextSide.outerHeight(!0))/2+"px) translateZ("+-$activeSide.outerHeight(!0)/2+"px) rotateX(-90deg)"}},down:function(){return{transform:"translateY("+-($activeSide.outerHeight(!0)-$nextSide.outerHeight(!0))/2+"px) translateZ("+-$activeSide.outerHeight(!0)/2+"px) rotateX(90deg)"}},left:function(){return{transform:"translateX("+-($activeSide.outerWidth(!0)-$nextSide.outerWidth(!0))/2+"px) translateZ("+-$activeSide.outerWidth(!0)/2+"px) rotateY(90deg)"}},right:function(){return{transform:"translateX("+-($activeSide.outerWidth(!0)-$nextSide.outerWidth(!0))/2+"px) translateZ("+-$activeSide.outerWidth(!0)/2+"px) rotateY(-90deg)"}},over:function(){return{transform:"translateX("+-($activeSide.outerWidth(!0)-$nextSide.outerWidth(!0))/2+"px) rotateY(180deg)"}},back:function(){return{transform:"translateX("+-($activeSide.outerWidth(!0)-$nextSide.outerWidth(!0))/2+"px) rotateY(-180deg)"}}},transitionEvent:function(){var e,t=document.createElement("element"),i={transition:"transitionend",OTransition:"oTransitionEnd",MozTransition:"transitionend",WebkitTransition:"webkitTransitionEnd"};for(e in i)if(void 0!==t.style[e])return i[e]},nextSide:function(){return 0<$activeSide.next(o.side).length?$activeSide.next(o.side):$module.find(o.side).first()}},stage:{above:function(){var e={origin:($activeSide.outerHeight(!0)-$nextSide.outerHeight(!0))/2,depth:{active:$nextSide.outerHeight(!0)/2,next:$activeSide.outerHeight(!0)/2}};d.verbose("Setting the initial animation position as above",$nextSide,e),$sides.css({transform:"translateZ(-"+e.depth.active+"px)"}),$activeSide.css({transform:"rotateY(0deg) translateZ("+e.depth.active+"px)"}),$nextSide.classList.add(r.animating).css({top:e.origin+"px",transform:"rotateX(90deg) translateZ("+e.depth.next+"px)"})},below:function(){var e={origin:($activeSide.outerHeight(!0)-$nextSide.outerHeight(!0))/2,depth:{active:$nextSide.outerHeight(!0)/2,next:$activeSide.outerHeight(!0)/2}};d.verbose("Setting the initial animation position as below",$nextSide,e),$sides.css({transform:"translateZ(-"+e.depth.active+"px)"}),$activeSide.css({transform:"rotateY(0deg) translateZ("+e.depth.active+"px)"}),$nextSide.classList.add(r.animating).css({top:e.origin+"px",transform:"rotateX(-90deg) translateZ("+e.depth.next+"px)"})},left:function(){var e=$activeSide.outerWidth(!0),t=$nextSide.outerWidth(!0),i={origin:(e-t)/2,depth:{active:t/2,next:e/2}};d.verbose("Setting the initial animation position as left",$nextSide,i),$sides.css({transform:"translateZ(-"+i.depth.active+"px)"}),$activeSide.css({transform:"rotateY(0deg) translateZ("+i.depth.active+"px)"}),$nextSide.classList.add(r.animating).css({left:i.origin+"px",transform:"rotateY(-90deg) translateZ("+i.depth.next+"px)"})},right:function(){var e=$activeSide.outerWidth(!0),t=$nextSide.outerWidth(!0),i={origin:(e-t)/2,depth:{active:t/2,next:e/2}};d.verbose("Setting the initial animation position as left",$nextSide,i),$sides.css({transform:"translateZ(-"+i.depth.active+"px)"}),$activeSide.css({transform:"rotateY(0deg) translateZ("+i.depth.active+"px)"}),$nextSide.classList.add(r.animating).css({left:i.origin+"px",transform:"rotateY(90deg) translateZ("+i.depth.next+"px)"})},behind:function(){var e=$activeSide.outerWidth(!0),t=$nextSide.outerWidth(!0),i={origin:(e-t)/2,depth:{active:t/2,next:e/2}};d.verbose("Setting the initial animation position as behind",$nextSide,i),$activeSide.css({transform:"rotateY(0deg)"}),$nextSide.classList.add(r.animating).css({left:i.origin+"px",transform:"rotateY(-180deg)"})}}}},ui.shape.settings={silent:!1,debug:!1,verbose:!1,jitter:0,performance:!0,namespace:"shape",width:"initial",height:"initial",allowRepeats:!1,duration:!1,beforeChange:function(){},onChange:function(){},selector:{sides:".sides",side:".side"},error:{side:"You tried to switch to a side that does not exist.",method:"The method you called is not defined"},className:{animating:"animating",hidden:"hidden",loading:"loading",active:"active"}};