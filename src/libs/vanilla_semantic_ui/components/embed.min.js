ui.embed=function(n,t){var a,o=t.selector,r=t.className,c=t.sources,i=t.error,d=t.metadata,l=t.templates,u=(n.querySelectorAll(o.placeholder),n.querySelectorAll(o.icon),n.querySelectorAll(o.embed));return a={initialize:function(){a.debug("Initializing embed"),a.determine.autoplay(),a.create(),a.bind.events()},refresh:function(){a.verbose("Refreshing selector cache"),n.querySelector(o.placeholder),n.querySelector(o.icon),u=n.querySelector(o.embed)},bind:{events:function(){a.has.placeholder()&&(a.debug("Adding placeholder events"),n.onclick=function(e){(ui.checkTarget(e,o.placeholder)||ui.checkTarget(e,o.icon))&&a.createAndShow()})}},create:function(){a.get.placeholder()?a.createPlaceholder():a.createAndShow()},createPlaceholder:function(e){var o=a.get.icon(),r=a.get.url();a.generate.embed(r);e=e||a.get.placeholder(),n.innerHTML=l.placeholder(e,o),a.debug("Creating placeholder for embed",e,o)},createEmbed:function(e){a.refresh(),e=e||a.get.url(),(u=document.createElement("div")).classList.add(r.embed),u.innerHTML=a.generate.embed(e),n.append(u),t.onCreate.call(n,e),a.debug("Creating embed object",u)},changeEmbed:function(e){u.innerHTML=a.generate.embed(e)},createAndShow:function(){a.createEmbed(),a.show()},change:function(e,o,r){a.debug("Changing video to ",e,o,r),n.dataset[d.source]=e,n.dataset[d.id]=o,r?n.dataset[(d.url,r)]:n.dataset[d.url]=void 0,a.has.embed()?a.changeEmbed():a.create()},reset:function(){a.debug("Clearing embed and showing placeholder"),a.remove.active(),a.remove.embed(),a.showPlaceholder(),t.onReset.call(n)},show:function(){a.debug("Showing embed"),a.set.active(),t.onDisplay.call(n)},hide:function(){a.debug("Hiding embed"),a.showPlaceholder()},showPlaceholder:function(){a.debug("Showing placeholder image"),a.remove.active(),t.onPlaceholderDisplay.call(n)},get:{id:function(){return t.id||n.dataset[d.id]},placeholder:function(){return t.placeholder||n.dataset[d.placeholder]},icon:function(){return t.icon?t.icon:void 0!==n.dataset[d.icon]?n.dataset[d.icon]:a.determine.icon()},source:function(e){return t.source?t.source:void 0!==n.dataset[d.source]?n.dataset[d.source]:a.determine.source()},type:function(){var e=a.get.source();return void 0!==c[e]&&c[e].type},url:function(){return t.url?t.url:void 0!==n.dataset[d.url]?n.dataset[d.url]:a.determine.url()}},determine:{autoplay:function(){a.should.autoplay()&&(t.autoplay=!0)},source:function(r){var t=!1;return(r=r||a.get.url())&&c.forEach(c,function(e,o){if(-1!==r.search(e.domain))return t=o,!1}),t},icon:function(){var e=a.get.source();return void 0!==c[e]&&c[e].icon},url:function(){var e=t.id||n.dataset[d.id],o=t.source||n.dataset[d.source],r=void 0!==c[o]&&c[o].url.replace("{id}",e);return r&&(n.dataset[d.url]=r),r}},set:{active:function(){n.classList.add(r.active)}},remove:{active:function(){n.classList.remove(r.active)},embed:function(){u.innerHTML=""}},encode:{parameters:function(e){var o,r=[];for(o in e)r.push(encodeURIComponent(o)+"="+encodeURIComponent(e[o]));return r.join("&amp;")}},generate:{embed:function(e){a.debug("Generating embed html");var o,r,t=a.get.source();return(e=a.get.url(e))?(r=a.generate.parameters(t),o=l.iframe(e,r)):a.error(i.noURL,n),o},parameters:function(e,o){var r=c[e]&&void 0!==c[e].parameters?c[e].parameters(t):{};return(o=o||t.parameters)&&(r=ui.extend({},r,o)),r=t.onEmbed(r),a.encode.parameters(r)}},has:{embed:function(){return 0<u.length},placeholder:function(){return t.placeholder||n.dataset[d.placeholder]}},should:{autoplay:function(){return"auto"===t.autoplay?t.placeholder||void 0!==n.dataset[d.placeholder]:t.autoplay}},is:{video:function(){return"video"==a.get.type()}}}},ui.embed.settings={silent:!1,debug:!1,verbose:!1,performance:!0,icon:!1,source:!1,url:!1,id:!1,autoplay:"auto",color:"#444444",hd:!0,brandedUI:!1,parameters:!1,api:!1,onPause:function(){},onPlay:function(){},onStop:function(){},onDisplay:function(){},onPlaceholderDisplay:function(){},onReset:function(){},onCreate:function(e){},onEmbed:function(e){return e},className:{active:"active",embed:"embed"},error:{noURL:"No URL specified",method:"The method you called is not defined"},selector:{embed:".embed",placeholder:".placeholder",icon:".icon"},metadata:{id:"id",icon:"icon",placeholder:"placeholder",source:"source",url:"url"},sources:{youtube:{name:"youtube",type:"video",icon:"video play",domain:"youtube.com",url:"//www.youtube.com/embed/{id}",parameters:function(e){return{autohide:!e.brandedUI,autoplay:e.autoplay,color:e.color||void 0,hq:e.hd,jsapi:e.api,modestbranding:!e.brandedUI}}},vimeo:{name:"vimeo",type:"video",icon:"video play",domain:"vimeo.com",url:"//player.vimeo.com/video/{id}",parameters:function(e){return{api:e.api,autoplay:e.autoplay,byline:e.brandedUI,color:e.color||void 0,portrait:e.brandedUI,title:e.brandedUI}}}},templates:{iframe:function(e,o){var r=e;return o&&(r+="?"+o),'<iframe src="'+r+'" width="100%" height="100%" frameborder="0" scrolling="no" webkitAllowFullScreen mozallowfullscreen allowFullScreen></iframe>'},placeholder:function(e,o){var r="";return o&&(r+='<i class="'+o+' icon"></i>'),e&&(r+='<img class="placeholder" src="'+e+'">'),r}}};