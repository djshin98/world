ui.progress=function(r,a){var o,t=a.className,n=a.metadata,e=a.selector,i=a.error,s=r.querySelector(e.bar),l=r.querySelectorAll(e.progress),u=r.querySelectorAll(e.label),c=!1;return o={initialize:function(){o.debug("Initializing progress bar",a),o.set.duration(),o.set.transitionEvent(),o.read.metadata(),o.read.settings()},reset:function(){o.remove.nextValue(),o.update.progress(0)},complete:function(){(void 0===o.percent||o.percent<100)&&(o.remove.progressPoll(),o.set.percent(100))},read:{metadata:function(){var e={percent:r.dataset[n.percent],total:r.dataset[n.total],value:r.dataset[n.value]};e.percent&&(o.debug("Current percent value set from metadata",e.percent),o.set.percent(e.percent)),e.total&&(o.debug("Total value set from metadata",e.total),o.set.total(e.total)),e.value&&(o.debug("Current value set from metadata",e.value),o.set.value(e.value),o.set.progress(e.value))},settings:function(){!1!==a.total&&(o.debug("Current total set in settings",a.total),o.set.total(a.total)),!1!==a.value&&(o.debug("Current value set in settings",a.value),o.set.value(a.value),o.set.progress(o.value)),!1!==a.percent&&(o.debug("Current percent set in settings",a.percent),o.set.percent(a.percent))}},bind:{transitionEnd:function(t){var e=o.get.transitionEnd();s.addEventListener(e,function(e){clearTimeout(o.failSafeTimer),t.call(this,e),e.target.removeEventListener(e.type,arguments.callee)}),o.failSafeTimer=setTimeout(function(){s.dispatchEvent(e)},a.duration+a.failSafeDelay),o.verbose("Adding fail safe timer",o.timer)}},increment:function(e){var t,n;o.has.total()?n=(t=o.get.value())+(e=e||1):(n=(t=o.get.percent())+(e=e||o.get.randomValue()),100,o.debug("Incrementing percentage by",t,n)),n=o.get.normalizedValue(n),o.set.progress(n)},decrement:function(e){var t,n;o.get.total()?(n=(t=o.get.value())-(e=e||1),o.debug("Decrementing value by",e,t)):(n=(t=o.get.percent())-(e=e||o.get.randomValue()),o.debug("Decrementing percentage by",e,t)),n=o.get.normalizedValue(n),o.set.progress(n)},has:{progressPoll:function(){return o.progressPoll},total:function(){return!1!==o.get.total()}},get:{text:function(e){var t=o.value||0,n=o.total||0,r=c?o.get.displayPercent():o.percent||0,a=0<o.total?n-t:100-r;return e=(e=e||"").replace("{value}",t).replace("{total}",n).replace("{left}",a).replace("{percent}",r),o.verbose("Adding variables to progress bar text",e),e},normalizedValue:function(e){if(e<0)return o.debug("Value cannot decrement below 0"),0;if(o.has.total()){if(e>o.total)return o.debug("Value cannot increment above total",o.total),o.total}else if(100<e)return o.debug("Value cannot increment above 100 percent"),100;return e},updateInterval:function(){return"auto"==a.updateInterval?a.duration:a.updateInterval},randomValue:function(){return o.debug("Generating random increment percentage"),Math.floor(Math.random()*a.random.max+a.random.min)},numericValue:function(e){return"string"==typeof e?""!==e.replace(/[^\d.]/g,"")&&+e.replace(/[^\d.]/g,""):e},transitionEnd:function(){var e,t=document.createElement("element"),n={transition:"transitionend",OTransition:"oTransitionEnd",MozTransition:"transitionend",WebkitTransition:"webkitTransitionEnd"};for(e in n)if(void 0!==t.style[e])return n[e]},displayPercent:function(){var e=s.width,t=r.width,n=parseInt(s.style.minWidth,10)<e?e/t*100:o.percent;return 0<a.precision?Math.round(n*(10*a.precision))/(10*a.precision):Math.round(n)},percent:function(){return o.percent||0},value:function(){return o.nextValue||o.value||0},total:function(){return o.total||!1}},create:{progressPoll:function(){o.progressPoll=setTimeout(function(){o.update.toNextValue(),o.remove.progressPoll()},o.get.updateInterval())}},is:{complete:function(){return o.is.success()||o.is.warning()||o.is.error()},success:function(){return r.classList.contains(t.success)},warning:function(){return r.classList.contains(t.warning)},error:function(){return r.classList.contains(t.error)},active:function(){return r.classList.contains(t.active)},visible:function(){return ui.isVisible(r)}},remove:{progressPoll:function(){o.verbose("Removing progress poll timer"),o.progressPoll&&(clearTimeout(o.progressPoll),delete o.progressPoll)},nextValue:function(){o.verbose("Removing progress value stored for next update"),delete o.nextValue},state:function(){o.verbose("Removing stored state"),delete o.total,delete o.percent,delete o.value},active:function(){o.verbose("Removing active state"),r.classList.remove(t.active)},success:function(){o.verbose("Removing success state"),r.classList.remove(t.success)},warning:function(){o.verbose("Removing warning state"),r.classList.remove(t.warning)},error:function(){o.verbose("Removing error state"),r.classList.remove(t.error)}},set:{barWidth:function(e){100<e?o.error(i.tooHigh,e):e<0?o.error(i.tooLow,e):(s.style.width=e+"%",r.setAttribute("data-percent",parseInt(e,10)))},duration:function(e){e="number"==typeof(e=e||a.duration)?e+"ms":e,o.verbose("Setting progress bar transition duration",e),s.style.transitionDuration=e},percent:function(e){e="string"==typeof e?+e.replace("%",""):e,e=0<a.precision?Math.round(e*(10*a.precision))/(10*a.precision):Math.round(e),o.percent=e,o.has.total()||(o.value=0<a.precision?Math.round(e/100*o.total*(10*a.precision))/(10*a.precision):Math.round(e/100*o.total*10)/10,a.limitValues&&(o.value=100<o.value?100:o.value<0?0:o.value)),o.set.barWidth(e),o.set.labelInterval(),o.set.labels(),a.onChange.call(r,e,o.value,o.total)},labelInterval:function(){clearInterval(o.interval),o.bind.transitionEnd(function(){o.verbose("Bar finished animating, removing continuous label updates"),clearInterval(o.interval),c=!1,o.set.labels()}),c=!0,o.interval=setInterval(function(){clearInterval(o.interval),c=!1,o.set.labels()},a.framerate)},labels:function(){o.verbose("Setting both bar progress and outer label text"),o.set.barLabel(),o.set.state()},label:function(e){(e=e||"")&&(e=o.get.text(e),o.verbose("Setting label to text",e),u.textContent=e)},state:function(e){100===(e=void 0!==e?e:o.percent)?a.autoSuccess&&!(o.is.warning()||o.is.error()||o.is.success())?(o.set.success(),o.debug("Automatically triggering success at 100%")):(o.verbose("Reached 100% removing active state"),o.remove.active(),o.remove.progressPoll()):0<e?(o.verbose("Adjusting active progress bar label",e),o.set.active()):(o.remove.active(),o.set.label(a.text.active))},barLabel:function(e){void 0!==e?l.textContent=o.get.text(e):"ratio"==a.label&&o.total?(o.verbose("Adding ratio to bar label"),l.textContent=o.get.text(a.text.ratio)):"percent"==a.label&&(o.verbose("Adding percentage to bar label"),l.textContent=o.get.text(a.text.percent))},active:function(e){e=e||a.text.active,o.debug("Setting active state"),a.showActivity&&!o.is.active()&&r.classList.add(t.active),o.remove.warning(),o.remove.error(),o.remove.success(),(e=a.onLabelUpdate("active",e,o.value,o.total))&&o.set.label(e),o.bind.transitionEnd(function(){a.onActive.call(r,o.value,o.total)})},success:function(e){e=e||a.text.success||a.text.active,o.debug("Setting success state"),r.classList.add(t.success),o.remove.active(),o.remove.warning(),o.remove.error(),o.complete(),e=a.text.success?a.onLabelUpdate("success",e,o.value,o.total):a.onLabelUpdate("active",e,o.value,o.total),o.set.label(e),o.bind.transitionEnd(function(){a.onSuccess.call(r,o.total)})},warning:function(e){e=e||a.text.warning,o.debug("Setting warning state"),r.classList.add(t.warning),o.remove.active(),o.remove.success(),o.remove.error(),o.complete(),(e=a.onLabelUpdate("warning",e,o.value,o.total))&&o.set.label(e),o.bind.transitionEnd(function(){a.onWarning.call(r,o.value,o.total)})},error:function(e){e=e||a.text.error,o.debug("Setting error state"),r.classList.add(t.error),o.remove.active(),o.remove.success(),o.remove.warning(),o.complete(),(e=a.onLabelUpdate("error",e,o.value,o.total))&&o.set.label(e),o.bind.transitionEnd(function(){a.onError.call(r,o.value,o.total)})},transitionEvent:function(){o.get.transitionEnd()},total:function(e){o.total=e},value:function(e){o.value=e},progress:function(e){o.has.progressPoll()?(o.debug("Updated within interval, setting next update to use new value",e),o.set.nextValue(e)):(o.debug("First update in progress update interval, immediately updating",e),o.update.progress(e),o.create.progressPoll())},nextValue:function(e){o.nextValue=e}},update:{toNextValue:function(){var e=o.nextValue;e&&(o.debug("Update interval complete using last updated value",e),o.update.progress(e),o.remove.nextValue())},progress:function(e){var t;!1===(e=o.get.numericValue(e))&&o.error(i.nonNumeric,e),e=o.get.normalizedValue(e),o.has.total()?(o.set.value(e),t=e/o.total*100,o.debug("Calculating percent complete from total",t)):(t=e,o.debug("Setting value to exact percentage value",t)),o.set.percent(t)}}}},ui.progress.settings={silent:!1,debug:!1,verbose:!1,performance:!0,duration:300,updateInterval:"auto",autoSuccess:!0,showActivity:!0,limitValues:!0,label:"percent",precision:0,framerate:1e3/30,percent:!1,total:!1,value:!1,failSafeDelay:100,onLabelUpdate:function(e,t,n,r){return t},onChange:function(e,t,n){},onSuccess:function(e){},onActive:function(e,t){},onError:function(e,t){},onWarning:function(e,t){},regExp:{variable:/\{\$*[A-z0-9]+\}/g},random:{min:2,max:5},metadata:{percent:"percent",total:"total",value:"value"},selector:{bar:".bar",label:"label",progress:".bar > .progress"},className:{active:"active",error:"error",success:"success",warning:"warning"},error:{method:"The method you called is not defined.",nonNumeric:"Progress value is non numeric",tooHigh:"Value specified is above 100%",tooLow:"Value specified is below 0%"},text:{active:!1,error:!1,success:!1,warning:!1,percent:"{percent}%",ratio:"{value} of {total}"}};