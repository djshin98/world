ui.rating=function(n,a){var e,o,r=a.className,t=a.metadata,s=a.selector,c=(a.error,[].slice.call(n.querySelectorAll(s.icon)));return o={initialize:function(){o.verbose("Initializing rating module",a),0===c.length&&o.setup.layout(),a.interactive?o.enable():o.disable(),o.set.initialLoad(),o.set.rating(o.get.initialRating()),o.remove.initialLoad()},refresh:function(){c=[].slice.call(n.querySelectorAll(s.icon))},setup:{layout:function(){var e=o.get.maxRating(),t=ui.rating.settings.templates.icon(e);o.debug("Generating icon html dynamically"),n.innerHTML=t,o.refresh()}},event:{mouseenter:function(e){function t(e){e.classList.add(r.selected)}ui.checkTarget(e,s.icon)&&(ui.nextAll(this,function(e){e.classList.remove(r.selected)}),t(n),t(this),ui.prevAll(this,t))},mouseleave:function(e){if(ui.checkTarget(e,s.icon))for(var t in n.classList.remove(r.selected),c)c[t].classList.remove(r.selected)},click:function(e){if(ui.checkTarget(e,s.icon)){var t=o.get.rating(),i=c.indexOf(e.target)+1;("auto"==a.clearable?1===c.length:a.clearable)&&t==i?o.clearRating():o.set.rating(i)}}},clearRating:function(){o.debug("Clearing current rating"),o.set.rating(0)},bind:{events:function(){o.verbose("Binding events"),n.onclick=o.event.click,n.onmouseover=o.event.mouseenter,n.onmouseout=o.event.mouseleave}},unbind:{events:function(){o.verbose("Removing events"),n.onclick=void 0,n.onmouseover=void 0,n.onmouseout=void 0}},remove:{initialLoad:function(){e=!1}},enable:function(){o.debug("Setting rating to interactive mode"),o.bind.events(),n.classList.remove(r.disabled)},disable:function(){o.debug("Setting rating to read-only mode"),o.unbind.events(),n.classList.add(r.disabled)},is:{initialLoad:function(){return e}},get:{initialRating:function(){var e=n.dataset[t.rating];return void 0!==e?(n.removeAttribute("data-"+t.rating),e):a.initialRating},maxRating:function(){return void 0!==n.dataset[t.maxRating]?(n.dataset[t.maxRating]=null,n.dataset[t.maxRating]):a.maxRating},rating:function(){var e=c.filter(function(e){return e.matches("."+r.active)}).length;return o.verbose("Current rating retrieved",e),e}},set:{rating:function(e){var t=c[0<=e-1?e-1:0];for(var i in n.classList.remove(r.selected),c)c[i].classList.remove(r.selected),c[i].classList.remove(r.active);0<e&&(o.verbose("Setting current rating to",e),t.classList.add(r.active),ui.prevAll(t,function(e){e.classList.add(r.active)})),o.is.initialLoad()||a.onRate.call(n,e)},initialLoad:function(){e=!0}}}},ui.rating.settings={silent:!1,debug:!1,verbose:!1,performance:!0,initialRating:0,interactive:!0,maxRating:4,clearable:"auto",fireOnInit:!1,onRate:function(e){},selector:{icon:".icon"},metadata:{rating:"rating",maxRating:"maxRating"},error:{method:"The method you called is not defined",noMaximum:"No maximum rating specified. Cannot generate HTML automatically"},className:{active:"active",disabled:"disabled",selected:"selected",loading:"loading"},templates:{icon:function(e){for(var t=1,i="";t<=e;)i+='<i class="icon"></i>',t++;return i}}};