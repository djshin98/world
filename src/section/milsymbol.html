<style>
	table input[type="text"] {
		width: 100%;
	}
	.uploadform .btn_stat {
		background: #ddd;
		font-color: #fff;
	}
</style>
<script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.14.3/xlsx.full.min.js"></script>




<div class="paragraph column">
	<div class="">
		<p class="tit">지역  구분</p>
		<select name="userStatClass1" id="user-stat-class1" class="search_type leftselect" data-control="select" data-set="user-stat-class1" data-type="user-stat" data-dependency="user-stat-class2"  >
		</select>
		<select name="userStatClass2" id="user-stat-class2" class="search_type rightselect" data-control="select" data-set="user-stat-class2" data-type="user-stat">
		</select>
		
		<button type="button" class="btn_stat" onclick="fnExcelReport('사용자 통계')" style="float:right">양식 다운로드</button>
		
		<p class="tit tit2">등록 방법</p>
		<div data-control="radio" data-target="reg_method"></div>
		<!-- paging start -->
		<input type="text" name="" class="src_in textsearch" placeholder="제목을 입력하세요">
		<input type="text" name="" class="src_in textsearch" placeholder="통계 단위를 입력하세요">
		
		<div data-onresponse="reg_method" data-select="directly">
			<div data-control="table" data-subscribe="stat-user" data-target="agri-user-table" data-exceltable="true"></div>
		</div>	
		
		<input type="file" id="excelFile" style="display:none;"/>
		
		<div class="uploadform" data-onresponse="reg_method" data-select="upload" >
<!-- 			<input type="text" class="upload_text" readonly="readonly"> -->
			<!--button-->
			<div class="upload-btn_wrap">
<!-- 			  <button type="button" title="파일찾기"> -->
<!-- 			   <span>파일찾기</span>   -->
<!-- 			  </button> -->
			  <input type="file" id="excelFile"/>
			</div>
			<div>
				<button id="test" type="button" class="btn_stat">양식 다운로드</button><button id="test2" type="button" class="btn_stat">데이터 업로드</button>		
			</div>
		</div> 
		
		  
        
		<p class="cen_btn"> 
<!-- 		<button type="button" class="btn_stat" onclick="application.popup({key:'CultiHist',title:'인삼재배이력정보', icon:'fa fa-sitemap'});" >인삼재배이력정보</button> -->
<!-- 		<button type="button" class="btn_stat" onclick="application.popup({key:'edit.attr',title:'속성', icon:'fa fa-info-circle'});" >통계보고서</button> -->
<!-- 		<button type="button" class="btn_stat" onclick="application.popup({key:'soilchar',title:'토양 특성 정보', icon:'fa fa-info-circle'});" >토양특성정보</button> -->
<!-- 		<button type="button" class="btn_stat" onclick="application.popup({key:'ecoplant',title:'친환경재배지 정보', icon:'fa fa-info-circle'});" >친환경재배지</button> -->
<!-- 		<button type="button" class="btn_stat" onclick="application.popup({key:'fielddrought',title:'밭가뭄 정보', icon:'fa fa-info-circle'});" >밭가뭄</button> -->
<!-- 		<button type="button" class="btn_stat" onclick="application.popup({key:'riceculti',title:'벼 직파재배 적지 정보', icon:'fa fa-info-circle'});" >벼 직파재배 적지 정보</button> -->
<!-- 		<button type="button" class="btn_stat" onclick="application.popup({key:'statreport',title:'통계 보고서', icon:'fa fa-info-circle'});" >통계 보고서</button> -->
		<!-- <button type="button" class="btn_stat" onclick="application.chart({id:'chart_div', type:'pie'});" >pie</button>
		<button type="button" class="btn_stat" onclick="application.chart({id:'chart_div', type:'bar'});" >bar</button>
		<button type="button" class="btn_stat" onclick="application.chart({id:'chart_div', type:'treemap'});" >treemap</button> -->
		</p>
		<div id="chart_div" style="width: 900px; height: 500px;"></div>
	</div>
</div>

<script>

// function excelExport(event){
//     var input = event.target;
//     var reader = new FileReader();
//     reader.onload = function(){
//         var fileData = reader.result;
//         var wb = XLSX.read(fileData, {type : 'binary'});
//         wb.SheetNames.forEach(function(sheetName){
// 	        var rowObj =XLSX.utils.sheet_to_json(wb.Sheets[sheetName]);
// 	        console.log(JSON.stringify(rowObj));
//         })
//     };
//     reader.readAsBinaryString(input.files[0]);
// }
// function fnExcelReport(id, title) {
// 	var tab_text = '<html xmlns:x="urn:schemas-microsoft-com:office:excel">';
// 	tab_text = tab_text + '<head><meta http-equiv="content-type" content="application/vnd.ms-excel; charset=UTF-8">';
// 	tab_text = tab_text + '<xml><x:ExcelWorkbook><x:ExcelWorksheets><x:ExcelWorksheet>'
// 	tab_text = tab_text + '<x:Name>Test Sheet</x:Name>';
// 	tab_text = tab_text + '<x:WorksheetOptions><x:Panes></x:Panes></x:WorksheetOptions></x:ExcelWorksheet>';
// 	tab_text = tab_text + '</x:ExcelWorksheets></x:ExcelWorkbook></xml></head><body>';
// 	tab_text = tab_text + "<table border='1px'>";
// 	var exportTable = $('#' + id).clone();
// 	exportTable.find('input').each(function (index, elem) { $(elem).remove(); });
// 	tab_text = tab_text + exportTable.html();
// 	tab_text = tab_text + '</table></body></html>';
// 	var data_type = 'data:application/vnd.ms-excel';
// 	var ua = window.navigator.userAgent;
// 	var msie = ua.indexOf("MSIE ");
// 	var fileName = title + '.xls';
// 	//Explorer 환경에서 다운로드
// 	if (msie > 0 || !!navigator.userAgent.match(/Trident.*rv\:11\./)) {
// 	if (window.navigator.msSaveBlob) {
// 	var blob = new Blob([tab_text], {
// 	type: "application/csv;charset=utf-8;"
// 	});
// 	navigator.msSaveBlob(blob, fileName);
// 	}
// 	} else {
// 	var blob2 = new Blob([tab_text], {
// 	type: "application/csv;charset=utf-8;"
// 	});
// 	var filename = fileName;
// 	var elem = window.document.createElement('a');
// 	elem.href = window.URL.createObjectURL(blob2);
// 	elem.download = filename;
// 	document.body.appendChild(elem);
// 	elem.click();
// 	document.body.removeChild(elem);
// 	}
// }

</script>