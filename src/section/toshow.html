<div class="section-content">
    <div class="ui" style="margin-bottom: 0.5em;">
        <div class="ui right">
            <button class="ui primary button mini" onclick="toshowView()">Get</button>
        </div>
        <div class="ui right">
            <!-- <button class="ui primary button mini" onclick="app.collections['ALLY'].removeAll()">
                off
            </button> -->
        </div>
    </div>
    <div id="toshow-view" class="filetree" style="height: 100%;"></div>
</div>

<script>
   
    function toshowView() {
        if (app.collections['ALLY'].objects.length > 0) {
            return;
        } else {
            serverAdapter.get('Entities', {}, function(resultdata) {
                var node = [{
                    name: '아군부대',
                    id: 'ALLY',
                    children: [],
                }, {
                    name: 'bmoa',
                    id: 'BMOA',
                    children: [],
                }, {
                    name: '적부대',
                    id: 'ENEMY',
                    children: [],
                }, ];
                var index = 0;
                let allyCollection = app.getCollection('ALLY');
                let enemyCollection = app.getCollection('ENEMY');
                var options = {};
                for (var r in resultdata) {
                    node[index].children = resultdata[r].reduce(function(prev, curr, i) {
                        if (curr.hasOwnProperty('unit_name')) {
                            prev.push({
                                name: curr.unit_name,
                                cartesianVal: Cesium.Cartesian3.fromDegrees(
                                    parseFloat(curr.geocd_lngt),
                                    parseFloat(curr.geocd_ltd),
                                    0
                                ),
                                x: curr.geocd_lngt,
                                y: curr.geocd_ltd,
                                sic: curr.unit_sbl_cd,
                            });
                        } else {
                            prev.push({
                                name: curr.bmoa_id,
                                cartesianVal: Cesium.Cartesian3.fromDegrees(
                                    parseFloat(curr.geocd_lngt),
                                    parseFloat(curr.geocd_ltd),
                                    0
                                ),
                                rad : curr.bmoa_rads,
                                x: curr.geocd_lngt,
                                y: curr.geocd_ltd,
                                sic: curr.unit_sbl_cd
                            });
                        }
                        return prev;
                    }, []);
                    index++;
                }
                new OliveTree('#toshow-view', node, {
                    onText: function(d) {
                        return d.name;
                    },
                });

                // document.querySelector("[data-content='Home']").className
                /* node.forEach(function(n, i) {
                                    if (i === 0) {
                                        n.children.forEach(function(d) {
                                            d.size = 30;
                                            allyCollection.add(d.cartesianVal, d);
                                        });
                                    } else if (i === 2) {
                                        n.children.forEach(function(d) {
                                            d.size = 30;
                                            enemyCollection.add(d.cartesianVal, d);
                                        });
                                    }
                                }); */
            });
        }
    }
</script>